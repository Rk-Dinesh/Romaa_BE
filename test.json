const sampleCSv = `itemNo,category,description,unit,working_quantity,rate
ABS001,MAIN_ITEM,,Cum,855.36,
ABS001,MY-M,Hire JCB,Month,2,80000
ABS001,MY-M,Tractor,Month,1,45000
ABS001,MY-F,Diesel,Lit,1275,96
ABS001,MP-C,Blasting,Points,1100,180
ABS001,MP-NMR,Helpers,Nos,60,700
ABS002,MAIN_ITEM,,Cum,684.288,
ABS002,MY-M,Hire JCB,Month,0.5,80000
ABS002,MY-F,Diesel,Lit,112.5,96
ABS002,MP-NMR,Helpers,Nos,15,700
`;
{
  "tender_id": "TND014",
  "work_items": [
    {
      "itemNo": 1,
      "workItem": "Laying and curing concrete for foundation",
      "unit": "Cum",
      "working_quantity": 855.36,
      "category": "MAIN_ITEM",
      "MT_CM_rate": 0,
      "MT_BL_rate": 0,
      "MY_M_rate": 239.67,
      "MY_F_rate": 143.09,
      "MP_C_rate": 231.48,
      "MP_NMR_rate":49.10,
      "final_rate": 663.35,
      "lines": [
        {
          "category": "MY-M",
          "description": "Hire JCB",
          "unit": "Month",
          "quantity": 2,
          "rate": 80000,
          "amount": 160000,
          "total_rate": 187.0557
        },
        {
          "category": "MY-M",
          "description": "Tractor",
          "unit": "Month",
          "quantity": 1,
          "rate": 45000,
          "amount": 45000,
          "total_rate": 52.6094
        },
        {
          "category": "MY-F",
          "description": "Diesel",
          "unit": "Lit",
          "quantity": 1275,
          "rate": 96,
          "amount": 122400,
          "total_rate": 143.0976
        },
        {
          "category": "MP-C",
          "description": "Blasting",
          "unit": "Points",
          "quantity": 1100,
          "rate": 180,
          "amount": 198000,
          "total_rate": 231.4814
        },
        {
          "category": "MP-NMR",
          "description": "Helpers",
          "unit": "Nos",
          "quantity": 60,
          "rate": 700,
          "amount": 42000,
          "total_rate": 49.1021
        }
      ]
    },
    {
      "itemNo": 2,
      "workItem": "Brick work in cement mortar 1:6",
      "unit": "Cum",
      "working_quantity": 684.288,
      "category": "MAIN_ITEM",
      "MT_CM_rate": 0,
      "MT_BL_rate": 0,
      "MY_M_rate": 58.45,
      "MY_F_rate": 15.78,
      "MP_C_rate": 0,
      "MP_NMR_rate": 15.34,
      "final_rate": 89.57,
      "lines": [
        {
          "category": "MY-M",
          "description": "Hire JCB",
          "unit": "Month",
          "quantity": 0.5,
          "rate": 80000,
          "amount": 40000,
          "total_rate": 58.4549
        },
        {
          "category": "MY-F",
          "description": "Diesel",
          "unit": "Lit",
          "quantity": 112.5,
          "rate": 96,
          "amount": 10800,
          "total_rate": 15.7828
        },
        {
          "category": "MP-NMR",
          "description": "Helpers",
          "unit": "Nos",
          "quantity": 15,
          "rate": 700,
          "amount": 10500,
          "total_rate": 15.3444
        }
      ]
    }
  ]
}

  
    // // Fetch SiteOverheads grand_total_overheads_rs
    // const siteOverheads = await SiteOverheads.findOne({ tender_id });
    // const siteoverhead_total_amount = Number(siteOverheads?.grand_total_overheads_rs || 0);

    // // Calculate summary values
    // const total_cost = zero_cost_total_amount + siteoverhead_total_amount;
    // const margin = total_cost - boq_total_amount;
    // const escalation_benefits_percentage = 0; // default
    // const total_margin = margin + (margin * escalation_benefits_percentage / 100);
    // const grossmargin_percentage = boq_total_amount > 0 ? (margin / boq_total_amount) * 100 : 0;
    // const risk_contingency = 0; // default
    // const ho_overheads = 0; // default
    // const PBT = grossmargin_percentage - risk_contingency - ho_overheads;

    // // Update bid summary
    // await WorkItemModel.updateOne(
    //   { tender_id },
    //   {
    //     $set: {
    //       "summary.zero_cost_total_amount": zero_cost_total_amount,
    //       "summary.siteoverhead_total_amount": siteoverhead_total_amount,
    //       "summary.total_cost": total_cost,
    //       "summary.boq_total_amount": boq_total_amount,
    //       "summary.margin": margin,
    //       "summary.total_margin": total_margin,
    //       "summary.escalation_benefits_percentage": escalation_benefits_percentage,
    //       "summary.grossmargin_percentage": grossmargin_percentage,
    //       "summary.risk_contingency": risk_contingency,
    //       "summary.ho_overheads": ho_overheads,
    //       "summary.PBT": PBT
    //     }
    //   }
    // );